<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>Ruby on Rails - Rails Migrations Cheatsheet - Dizzy</title>
	
	<link href="/stylesheets/main.css?1231895299" media="all" rel="stylesheet" type="text/css" />
	<link href="/stylesheets/syntax_highlighting.css?1230303584" media="all" rel="stylesheet" type="text/css" />
	
	<script src="/javascripts/prototype.js?1220877731" type="text/javascript"></script>
<script src="/javascripts/effects.js?1220877731" type="text/javascript"></script>
<script src="/javascripts/dragdrop.js?1220877731" type="text/javascript"></script>
<script src="/javascripts/controls.js?1220877731" type="text/javascript"></script>
<script src="/javascripts/application.js?1201129168" type="text/javascript"></script>
	
</head>

<body>	

	<div id="page_container">
		
		<div id="top_container">
	
	<div id="logo"><img alt="Dizzy logo" height="84" src="/images/f/branding/header/logo.png.?1201129165" width="85" /></div>
	
	<div id="right_of_logo">
		<img alt="Making business beautiful" height="32" src="/images/f/branding/header/slogan_new.png.?1201129165" width="182" />	
		<img alt="Makeover" src="/images/f/branding/header/0.png.?1201129165" />	
	</div>
	
</div>
		<div id="navigation">
	
<!-- HOME -->
	<div class="nav_button">
		
			<a href="/"><img alt="Home" src="/images/f/nav/home.png.?1231929764" /></a> <a href="/">Home</a>
		
	</div>

<!-- CHEATSHEETS -->
	<div class="nav_button">
		
			<a href="/ruby_on_rails/cheatsheets"><img alt="Cheats" src="/images/f/nav/cheats.png.?1231929839" /></a> <a href="/ruby_on_rails/cheatsheets">Cheatsheets</a>
		
	</div>	
	
<!-- RUBY ON RAILS -->
	<div class="nav_button">
		
		<a href="/ruby_on_rails/latest"><img alt="Rails_over" src="/images/f/nav/rails_over.png.?1231931371" /></a> <b>Ruby on Rails</b>
		
	</div>
	
<!-- PORTFOLIO -->
	<div class="nav_button">
		
			<a href="/portfolios"><img alt="Portfolio" src="/images/f/nav/portfolio.png.?1231929695" /></a> <a href="/portfolios">Portfolio</a>
		
	</div>
	
<!-- CONTACT -->
	<div id="contact_icon" class="nav_button">
		<a before="Element.show('contact_spinner')" complete="Element.hide('contact_spinner')" href="#" onclick="try {
$(&quot;contact_form&quot;).show();
} catch (e) { alert('RJS error:\n\n' + e.toString()); alert('$(\&quot;contact_form\&quot;).show();'); throw e }; return false;"><img alt="Contact" src="/images/f/nav/contact.png.?1231929853" /></a> 
	<a before="Element.show('contact_spinner')" complete="Element.hide('contact_spinner')" href="#" onclick="try {
$(&quot;contact_form&quot;).show();
} catch (e) { alert('RJS error:\n\n' + e.toString()); alert('$(\&quot;contact_form\&quot;).show();'); throw e }; return false;">Contact</a>
		<div id="contact_spinner" style="display:none;"><img alt="Spinner" src="/images/f/spinner.gif" /></div>
	</div>

</div>

<div id="contact_form" style="display:none;"></div>

		
		<div id="contact_form" style="display:none;"></div>
		
		<div id="content_container">
			<div id="breadcrumbs"><p><img alt="You are here:" height="24" src="/images/f/small_icons/you-are-here.gif.?1201129163" width="25" /> <a href="/">Home</a> <img alt="Solidarrow" src="/images/f/bullets/arrows/solidarrow.png.?1201129166" /> <a href="/ruby_on_rails/latest">Ruby on Rails</a> <img alt="Solidarrow" src="/images/f/bullets/arrows/solidarrow.png.?1201129166" /> <b></b></p></div>
				
<div id="left_column">
	
	<ul id="category_list" class="categories"><li id="category_31"><a href="/ruby_on_rails/categories/action-mailer">Action Mailer</a></li><li id="category_18"><a href="/ruby_on_rails/cheatsheets">Cheatsheets</a></li><li id="category_26"><a href="/ruby_on_rails/categories/file-handling">File Handling</a></li><li id="category_27"><a href="/ruby_on_rails/categories/helpers">Helpers</a></li><li id="category_34"><a href="/ruby_on_rails/categories/migrations">Migrations</a></li><li id="category_7"><a href="/ruby_on_rails/categories/models">Models</a></li><li id="category_29"><a href="/ruby_on_rails/categories/regular-expressions">Regular Expressions</a></li><li id="category_33"><a href="/ruby_on_rails/categories/relationships">Relationships</a></li><li id="category_35"><a href="/ruby_on_rails/categories/rjs">RJS</a></li><li id="category_11"><a href="/ruby_on_rails/categories/routing-and-urls">Routing and URLs</a></li><li id="category_32"><a href="/ruby_on_rails/categories/validations">Validations</a></li></ul>
	
	
	
	
		
			<p><div class="spiro"> &nbsp;</div></p>
			<div id="blurb">
				<h4><img alt="&gt;" height="9" src="/images/f/bullets/arrows/solidarrow.png.?1201129166" width="13" /> RELATED ARTICLE</h4>
				<h2><img alt="*" height="13" src="/images/f/bullets/pixels/asterisk.png.?1201129166" width="13" /> New in Rails 2.0: Sexy Migrations</h2> 
				<p>A look at the new features and syntax available in migrations on Rails 2.0 <img alt="&gt;" height="9" src="/images/f/bullets/arrows/solidarrow.png.?1201129166" width="13" /> <a href="/ruby_on_rails/contents/rails-2-sexy-migrations">More</a> </p>
			</div>
		
			<p><div class="spiro"> &nbsp;</div></p>
			<div id="blurb">
				<h4><img alt="&gt;" height="9" src="/images/f/bullets/arrows/solidarrow.png.?1201129166" width="13" /> RELATED ARTICLE</h4>
				<h2><img alt="*" height="13" src="/images/f/bullets/pixels/asterisk.png.?1201129166" width="13" /> Auto migrations</h2> 
				<p>A brilliant plugin that makes changing your database schema even easier and faster. <img alt="&gt;" height="9" src="/images/f/bullets/arrows/solidarrow.png.?1201129166" width="13" /> <a href="/ruby_on_rails/contents/auto-migrations">More</a> </p>
			</div>
		
				
				
</div>
			
<div id="right_column">
	
			




<h1>Rails Migrations Cheatsheet</h1>

<h2>Up and down methods, rake tasks, column mapping, loading fixtures, example migration file, all packed onto one A4 page for an easy at-a-glance reference. Updated for Rails 2.1</h2>

<div class="spiro"> &nbsp;</div>

<div id="article"><h1 id='table_of_contents'>Table of Contents</h1>
<div class='maruku_toc'><ul style='list-style: none;'><li><span class='maruku_section_number'>1. </span><a href='#table_methods'>Table methods</a><ul style='list-style: none;'><li><span class='maruku_section_number'>1.1. </span><a href='#change_table'>change_table</a></li><li><span class='maruku_section_number'>1.2. </span><a href='#create_table'>create_table</a><ul style='list-style: none;'><li><span class='maruku_section_number'>1.2.1. </span><a href='#table_options'>table_options</a></li></ul></li><li><span class='maruku_section_number'>1.3. </span><a href='#drop_table'>drop_table</a></li><li><span class='maruku_section_number'>1.4. </span><a href='#rename_table'>rename_table</a></li></ul></li><li><span class='maruku_section_number'>2. </span><a href='#example_migrationrb'>example_migration.rb</a></li><li><span class='maruku_section_number'>3. </span><a href='#database_mapping'>Database Mapping</a></li><li><span class='maruku_section_number'>4. </span><a href='#rake_tasks'>Rake tasks</a></li><li><span class='maruku_section_number'>5. </span><a href='#directory_structure'>Directory structure</a></li><li><span class='maruku_section_number'>6. </span><a href='#shortcut_methods'>Shortcut methods</a></li><li><span class='maruku_section_number'>7. </span><a href='#column_methods'>Column methods</a><ul style='list-style: none;'><li><span class='maruku_section_number'>7.1. </span><a href='#add_column'>add_column</a><ul style='list-style: none;'><li><span class='maruku_section_number'>7.1.1. </span><a href='#add_column_options'>column_options</a></li></ul></li><li><span class='maruku_section_number'>7.2. </span><a href='#change_column'>change_column</a></li><li><span class='maruku_section_number'>7.3. </span><a href='#rename_column'>rename_column</a></li><li><span class='maruku_section_number'>7.4. </span><a href='#remove_column'>remove_column</a></li></ul></li><li><span class='maruku_section_number'>8. </span><a href='#indexes'>Indexes</a><ul style='list-style: none;'><li><span class='maruku_section_number'>8.1. </span><a href='#add_index'>add_index</a></li><li><span class='maruku_section_number'>8.2. </span><a href='#remove_index'>remove_index</a></li></ul></li><li><span class='maruku_section_number'>9. </span><a href='#miscellaneous_methods'>Miscellaneous methods</a><ul style='list-style: none;'><li><span class='maruku_section_number'>9.1. </span><a href='#execute'>execute</a></li><li><span class='maruku_section_number'>9.2. </span><a href='#irreversiblemigration'>IrreversibleMigration</a></li></ul></li><li><span class='maruku_section_number'>10. </span><a href='#scriptgenerate'>script/generate</a></li><li><span class='maruku_section_number'>11. </span><a href='#loading_fixtures'>Loading fixtures</a><ul style='list-style: none;'><li><span class='maruku_section_number'>11.1. </span><a href='#customersyml'>customers.yml</a></li><li><span class='maruku_section_number'>11.2. </span><a href='#migrationrb'>migration.rb</a></li></ul></li></ul></div>
<h2 id='table_methods'><span class='maruku_section_number'>1. </span>Table methods</h2>

<h3 id='change_table'><span class='maruku_section_number'>1.1. </span>change_table</h3>

<p>Provides a block that enables you to alter columns on an existing table using various shortcut methods&#8230;</p>

<pre class='ruby'>change_table <span class='sy'>:table_name</span>,  {options} <span class='r'>do</span> |t|
  t.change <span class='sy'>:column_name</span>, <span class='sy'>:new_column_type</span>
  t.remove <span class='sy'>:column_name</span>
<span class='r'>end</span></pre>

<h3 id='create_table'><span class='maruku_section_number'>1.2. </span>create_table</h3>

<p>Creates a table on the database. Creates a table called <span class="code">:table_name</span> and makes the table object available to a block that can then add columns to it by specifying column_types or utilising shortcut methods such as using <span class="code">belongs_to</span> to specify foreign keys&#8230;</p>

<pre class='ruby'>create_table <span class='sy'>:table_name</span>, {table_options} <span class='r'>do</span> |t|
  t.string <span class='sy'>:name</span>, {column_options}
<span class='r'>end</span></pre>

<h4 id='table_options'><span class='maruku_section_number'>1.2.1. </span>table_options</h4>
<table><thead><tr><th>Key</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td style='text-align: left;'><span class="code">:force the issue</span></td><td style='text-align: left;'><span class="code">true or false</span></td><td style='text-align: left;'>if <span class="code">true</span>, forces drop of an existing table of the same name before creation the new one</td>
</tr><tr><td style='text-align: center;'><span class="code">:temporary</span></td><td style='text-align: left;'><span class="code">true or false</span></td><td style='text-align: left;'>if <span class="code">true</span>, creates a temporary table, one that goes away when the application disconnects from the database</td>
</tr><tr><td style='text-align: center;'><span class="code">:id</span></td><td style='text-align: left;'><span class="code">true or false</span></td><td style='text-align: left;'>if <span class="code">false</span>, defines a table with no primary key, for example when you need to define a join table</td>
</tr><tr><td style='text-align: center;'><span class="code">:primary_key</span></td><td style='text-align: left;'><span class="code">:symbol</span></td><td style='text-align: center;'>overrides the default name of <span class="code">:id</span></td>
</tr></tbody></table>
<h3 id='drop_table'><span class='maruku_section_number'>1.3. </span>drop_table</h3>

<p>Destroys the specified table.</p>

<pre class='ruby'>drop_table <span class='sy'>:table_name</span></pre>

<h3 id='rename_table'><span class='maruku_section_number'>1.4. </span>rename_table</h3>

<p>Renames the specified table.</p>

<pre class='ruby'>rename_table <span class='sy'>:old_table_name</span>, <span class='sy'>:new_table_name</span></pre>

<h2 id='example_migrationrb'><span class='maruku_section_number'>2. </span>example_migration.rb</h2>

<pre class="ruby"><span class='r'>class</span> <span class='cl'>CreateCustomers</span> &lt; <span class='co'>ActiveRecord</span>::<span class='co'>Migration</span>  

  <span class='r'>def</span> <span class='pc'>self</span>.up
    create_table <span class='sy'>:customers</span>, <span class='sy'>:primary_key</span> =&gt; <span class='sy'>:customer_id</span>, <span class='sy'>:options</span> =&gt; <span class='s'><span class='dl'>&quot;</span><span class='k'>auto_increment = 10000</span><span class='dl'>&quot;</span></span> <span class='r'>do</span> |t|
      t.integer <span class='sy'>:customer_id</span>
      t.string <span class='sy'>:name</span>,         <span class='sy'>:limit</span>   =&gt; <span class='i'>30</span>, <span class='sy'>:null</span> =&gt; <span class='pc'>false</span>
      t.integer <span class='sy'>:age</span>
      t.boolean <span class='sy'>:premium</span>,     <span class='sy'>:default</span> =&gt; <span class='i'>0</span>
      t.binary <span class='sy'>:photo</span>,        <span class='sy'>:limit</span>   =&gt; <span class='i'>2</span>.megabytes
      t.timestamps
      t.text <span class='sy'>:notes</span>,          <span class='sy'>:default</span> =&gt; <span class='s'><span class='dl'>&quot;</span><span class='k'>No notes recorded</span><span class='dl'>&quot;</span></span>
    <span class='r'>end</span>
    
    add_column <span class='sy'>:customers</span>, <span class='sy'>:surname</span>,  <span class='sy'>:string</span>,   <span class='sy'>:limit</span> =&gt; <span class='i'>50</span>    
    
    add_column <span class='sy'>:orders</span>,    <span class='sy'>:price</span>,    <span class='sy'>:decimal</span>,  <span class='sy'>:precision</span> =&gt; <span class='i'>8</span>, <span class='sy'>:scale</span> =&gt; <span class='i'>2</span>
    
    <span class='co'>Customer</span>.create <span class='sy'>:name</span> =&gt; <span class='s'><span class='dl'>&quot;</span><span class='k'>David</span><span class='dl'>&quot;</span></span>, <span class='sy'>:surname</span> =&gt; <span class='s'><span class='dl'>&quot;</span><span class='k'>Smith</span><span class='dl'>&quot;</span></span>, <span class='sy'>:age</span> =&gt; <span class='s'><span class='dl'>&quot;</span><span class='k'>32</span><span class='dl'>&quot;</span></span>, <span class='sy'>:premium</span> =&gt; <span class='s'><span class='dl'>&quot;</span><span class='k'>1</span><span class='dl'>&quot;</span></span>, <span class='sy'>:notes</span> =&gt; <span class='s'><span class='dl'>&quot;</span><span class='k'>One of our top customers!</span><span class='dl'>&quot;</span></span>
  <span class='r'>end</span>

  <span class='r'>def</span> <span class='pc'>self</span>.down 
    drop_table <span class='sy'>:customers</span>
  <span class='r'>end</span>
<span class='r'>end</span></pre>

<h2 id='database_mapping'><span class='maruku_section_number'>3. </span>Database Mapping</h2>
<table><thead><tr><th>Rails</th><th>db2</th><th>mysql</th><th>openbase</th><th>Oracle</th></tr></thead><tbody><tr><td style='text-align: left;'><span class="code">:binary</span></td><td style='text-align: left;'>blob(32678)</td><td style='text-align: left;'>blob</td><td style='text-align: left;'>object</td><td style='text-align: left;'>blob</td>
</tr><tr><td style='text-align: left;'><span class="code">:boolean</span></td><td style='text-align: left;'>decimal(1)</td><td style='text-align: left;'>tinyint(1)</td><td style='text-align: left;'>boolean</td><td style='text-align: left;'>number(10)</td>
</tr><tr><td style='text-align: left;'><span class="code">:date</span></td><td style='text-align: left;'>date</td><td style='text-align: left;'>date</td><td style='text-align: left;'>date</td><td style='text-align: left;'>date</td>
</tr><tr><td style='text-align: left;'><span class="code">:datetime</span></td><td style='text-align: left;'>timestamp</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>date</td>
</tr><tr><td style='text-align: left;'><span class="code">:decimal</span></td><td style='text-align: left;'>decimal</td><td style='text-align: left;'>decimal</td><td style='text-align: left;'>decimal</td><td style='text-align: left;'>decimal</td>
</tr><tr><td style='text-align: left;'><span class="code">:float</span></td><td style='text-align: left;'>float</td><td style='text-align: left;'>float</td><td style='text-align: left;'>float</td><td style='text-align: left;'>number</td>
</tr><tr><td style='text-align: left;'><span class="code">:integer</span></td><td style='text-align: left;'>int</td><td style='text-align: left;'>int(11)</td><td style='text-align: left;'>integer</td><td style='text-align: left;'>number(38)</td>
</tr><tr><td style='text-align: left;'><span class="code">:string</span></td><td style='text-align: left;'>varchar(255)</td><td style='text-align: left;'>varchar(255)</td><td style='text-align: left;'>char(4096)</td><td style='text-align: left;'>varchar2(255)</td>
</tr><tr><td style='text-align: left;'><span class="code">:text</span></td><td style='text-align: left;'>clob(32768)</td><td style='text-align: left;'>text</td><td style='text-align: left;'>text</td><td style='text-align: left;'>clob</td>
</tr><tr><td style='text-align: left;'><span class="code">:time</span></td><td style='text-align: left;'>time</td><td style='text-align: left;'>time</td><td style='text-align: left;'>time</td><td style='text-align: left;'>date</td>
</tr><tr><td style='text-align: left;'><span class="code">:timestamp</span></td><td style='text-align: left;'>timestamp</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>timestamp</td><td style='text-align: left;'>date</td>
</tr></tbody></table><table><thead><tr><th>Rails</th><th>postgresql</th><th>sqlite</th><th>sqlserver</th><th>Sybase</th></tr></thead><tbody><tr><td style='text-align: left;'><span class="code">:binary</span></td><td style='text-align: left;'>bytea</td><td style='text-align: left;'>blob</td><td style='text-align: left;'>image</td><td style='text-align: left;'>image</td>
</tr><tr><td style='text-align: left;'><span class="code">:boolean</span></td><td style='text-align: left;'>boolean</td><td style='text-align: left;'>boolean</td><td style='text-align: left;'>bit</td><td style='text-align: left;'>bit</td>
</tr><tr><td style='text-align: left;'><span class="code">:date</span></td><td style='text-align: left;'>date</td><td style='text-align: left;'>date</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>datetime</td>
</tr><tr><td style='text-align: left;'><span class="code">:datetime</span></td><td style='text-align: left;'>timestamp</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>datetime</td>
</tr><tr><td style='text-align: left;'><span class="code">:decimal</span></td><td style='text-align: left;'>decimal</td><td style='text-align: left;'>decimal</td><td style='text-align: left;'>decimal</td><td style='text-align: left;'>decimal</td>
</tr><tr><td style='text-align: left;'><span class="code">:float</span></td><td style='text-align: left;'>float</td><td style='text-align: left;'>float</td><td style='text-align: left;'>float(8)</td><td style='text-align: left;'>float(8)</td>
</tr><tr><td style='text-align: left;'><span class="code">:integer</span></td><td style='text-align: left;'>integer</td><td style='text-align: left;'>integer</td><td style='text-align: left;'>int</td><td style='text-align: left;'>int</td>
</tr><tr><td style='text-align: left;'><span class="code">:string</span></td><td style='text-align: left;'>*</td><td style='text-align: left;'>varchar(255)</td><td style='text-align: left;'>varchar(255)</td><td style='text-align: left;'>varchar(255)</td>
</tr><tr><td style='text-align: left;'><span class="code">:text</span></td><td style='text-align: left;'>text</td><td style='text-align: left;'>text</td><td style='text-align: left;'>text</td><td style='text-align: left;'>text</td>
</tr><tr><td style='text-align: left;'><span class="code">:time</span></td><td style='text-align: left;'>time</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>time</td>
</tr><tr><td style='text-align: left;'><span class="code">:timestamp</span></td><td style='text-align: left;'>timestamp</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>datetime</td><td style='text-align: left;'>timestamp</td>
</tr></tbody></table>
<h2 id='rake_tasks'><span class='maruku_section_number'>4. </span>Rake tasks</h2>

<dl>
<dt><span class="code">db:create</span></dt>

<dt><span class="code">db:create:all</span></dt>

<dd>Creates a single database specified in <span class="code">config/databases.yml</span> for the current <span class="code">RAILS_ENV</span> or creates all the databases</dd>

<dt><span class="code">db:drop</span></dt>

<dt><span class="code">db:drop:all</span></dt>

<dd>Drops a single database specified in <span class="code">config/databases.yml</span> for the current <span class="code">RAILS_ENV</span> or drops all the databases</dd>

<dt><span class="code">db:fixtures:load</span></dt>

<dd>Load fixtures from <span class="code">test/fixtures</span> into the current environment&#8217;s database</dd>

<dt><span class="code">db:migrate</span></dt>

<dd>Run all unapplied migrations</dd>

<dt><span class="code">db:migrate:up</span></dt>

<dt><span class="code">db:migrate:down</span></dt>

<dd>Move forward to the next migration, or back to the previous migration</dd>

<dt><span class="code">db:migrate VERSION=18</span></dt>

<dd>Migrate database to specific version</dd>

<dt><span class="code">db:migrate RAILS_ENV=production</span></dt>

<dd>Use migrations to recreate tables in the testing or production databases</dd>

<dt><span class="code">db:schema:dump</span></dt>

<dd>Create a <span class="code">db/schema.rb</span> file that can be portably used against any database supported by ActiveRecord</dd>

<dt><span class="code">db:schema:load</span></dt>

<dd>Load a schema.rb file into the database</dd>

<dt><span class="code">db:sessions:create</span></dt>

<dd>Create a sessions table for use with <span class="code">CGI::Sessions::ActiveRecordStore</span></dd>

<dt><span class="code">db:sessions:clear</span></dt>

<dd>Clear the sessions table</dd>

<dt><span class="code">db:structure:dump</span></dt>

<dd>Dump database structure to SQL file</dd>

<dt><span class="code">db:reset</span></dt>

<dd>Drops the database, creates the database and then runs migrations against the database. Takes a <span class="code">VERSION</span> argument as well as <span class="code">RAILS_ENV</span></dd>

<dt><span class="code">db:rollback STEP=4</span></dt>

<dd>Takes a STEP argument to determine how many version to rollback, the default being one version</dd>

<dt><span class="code">db:test:prepare</span></dt>

<dd>Clone your database structure into the test database</dd>

<dt><span class="code">db:version</span></dt>

<dd>Tells you the current version your database is at</dd>
</dl>

<h2 id='directory_structure'><span class='maruku_section_number'>5. </span>Directory structure</h2>

<ul>
<li><span class="code">rails_root</span> * db</li>

<li>Hello</li>
</ul>

<h2 id='shortcut_methods'><span class='maruku_section_number'>6. </span>Shortcut methods</h2>

<pre>t.column               t.change                t.rename
t.remove               t.change_default	   t.references    
t.remove_references    t.belongs_to            t.remove_belongs_to
t.timestamps           t.index                 t.remove_index</pre>

<h2 id='column_methods'><span class='maruku_section_number'>7. </span>Column methods</h2>

<h3 id='add_column'><span class='maruku_section_number'>7.1. </span>add_column</h3>

<p>Creates a new column on the specified table.</p>

<pre class="ruby">add_column <span class='sy'>:table_name</span>, <span class='sy'>:column_name</span>, <span class='sy'>:column_type</span>, {column_options}</span></pre>

<h4 id='add_column_options'><span class='maruku_section_number'>7.1.1. </span>column_options</h4>
<table><thead><tr><th>Key</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td style='text-align: left;'><span class="code">:null</span></td><td style='text-align: left;'><span class="code">true</span> or <span class="code">false</span></td><td style='text-align: left;'>if <span class="code">false</span>, the underlying column has a <span class="code">not null</span> constraint added by the database engine</td>
</tr><tr><td style='text-align: left;'><span class="code">:limit</span></td><td style='text-align: left;'><span class="code">integer</span></td><td style='text-align: left;'>set a limit on the size of the field</td>
</tr><tr><td style='text-align: left;'><span class="code">:default</span></td><td style='text-align: left;'><span class="code">string</span></td><td style='text-align: left;'>set a default value for the column</td>
</tr><tr><td style='text-align: left;'><span class="code">:precision</span></td><td style='text-align: left;'><span class="code">integer</span></td><td style='text-align: left;'>Specifies the precision for a <span class="code">:decimal</span> column.</td>
</tr><tr><td style='text-align: left;'><span class="code">:scale</span></td><td style='text-align: left;'><span class="code">integer</span></td><td style='text-align: left;'>Specifies the scale for a <span class="code">:decimal</span> column.</td>
</tr></tbody></table>
<h3 id='change_column'><span class='maruku_section_number'>7.2. </span>change_column</h3>

<p>Change the data type of the specified column</p>

<pre class="ruby">change_column <span class='sy'>:table_name</span>, <span class='sy'>:column_name</span>, <span class='sy'>:new_column_type</span></span></pre>

<h3 id='rename_column'><span class='maruku_section_number'>7.3. </span>rename_column</h3>

<p>Renames the specified column.</p>

<pre class="ruby">rename_column <span class='sy'>:table_name</span>, <span class='sy'>:old_column_name</span>, <span class='sy'>:new_column_name</span> </span></pre>

<h3 id='remove_column'><span class='maruku_section_number'>7.4. </span>remove_column</h3>

<p>Removes the specified column.</p>

<pre class="ruby">remove_column <span class='sy'>:table_name</span>, <span class='sy'>:column_name</span></span></pre>

<h2 id='indexes'><span class='maruku_section_number'>8. </span>Indexes</h2>

<h3 id='add_index'><span class='maruku_section_number'>8.1. </span>add_index</h3>

<p>Creates an index for the specified column.</p>

<pre class="ruby">add_index <span class='sy'>:table_name</span>, <span class='sy'>:column_name</span>, <span class='sy'>:unique</span> =&gt; <span class='pc'>true</span></span></pre>

<h3 id='remove_index'><span class='maruku_section_number'>8.2. </span>remove_index</h3>

<p>Remove an index from the specified column.</p>

<pre class="ruby">remove_index <span class='sy'>:table_name</span>, <span class='sy'>:column_name</span></span></pre>

<h2 id='miscellaneous_methods'><span class='maruku_section_number'>9. </span>Miscellaneous methods</h2>

<h3 id='execute'><span class='maruku_section_number'>9.1. </span>execute</h3>

<p>Takes a single string identifying a valid SQL command to execute directly.</p>

<pre class="ruby">execute <span class='s'><span class='dl'>&quot;</span><span class='k'>alter table line_items add constraint fk_line_item_products foreign key (product_id) references products(id)</span><span class='dl'>&quot;</span></span></span></pre>

<h3 id='irreversiblemigration'><span class='maruku_section_number'>9.2. </span>IrreversibleMigration</h3>

<p>Use in the down method of a migration file to raise an exception when the up methods of the same migration file can not be reversed, e.g. changing a column type from <span class="code">:integer</span> to <span class="code">:string</span>.</p>

<pre class="ruby">raise <span class='co'>ActiveRecord</span>::<span class='co'>IrreversibleMigration</span></span></pre>

<h2 id='scriptgenerate'><span class='maruku_section_number'>10. </span>script/generate</h2>

<pre><code class='plaintext'>script/generate migration new_migration_filename 
  field_name:column_type name:string age:integer date_of_birth:date</span></pre>

<h2 id='loading_fixtures'><span class='maruku_section_number'>11. </span>Loading fixtures</h2>

<p>Fixtures contain data which can be loaded into your database using migrations. For example, to load data into a table named customers&#8230;</p>

<ul>
<li>Create a directory, db/migrate/data</li>

<li>Create a file, customers.yml, inside db/migrate/data</li>

<li>Generate a new migration file: <span class="code">ruby script/generate migration load_customers_data</span></li>

<li>Edit it to load data from the <span class="code">customers.yml</span> file into your customers table</li>
</ul>

<h3 id='customersyml'><span class='maruku_section_number'>11.1. </span>customers.yml</h3>

<pre class="ruby">melissa:
  name: <span class='co'>Melissa</span>
  age: <span class='i'>18</span>
david: 
  name: <span class='co'>David</span>
  age: <span class='i'>23</span>        </span></pre>

<h3 id='migrationrb'><span class='maruku_section_number'>11.2. </span>migration.rb</h3>

<pre class="ruby">require <span class='s'><span class='dl'>'</span><span class='k'>active_record/fixtures</span><span class='dl'>'</span></span>
<span class='r'>class</span> <span class='cl'>LoadCustomerData</span>
 <span class='r'>def</span> <span class='pc'>self</span>.up
  down
  directory = <span class='co'>File</span>.join(<span class='co'>File</span>.dirname(<span class='pc'>__FILE__</span>), <span class='s'><span class='dl'>&quot;</span><span class='k'>data</span><span class='dl'>&quot;</span></span>)
  <span class='co'>Fixtures</span>.create_fixtures(directory, <span class='s'><span class='dl'>&quot;</span><span class='k'>customers</span><span class='dl'>&quot;</span></span>)
 <span class='r'>end</span>
 <span class='r'>def</span> <span class='pc'>self</span>.down
  <span class='co'>Customer</span>.delete_all
 <span class='r'>end</span>
<span class='r'>end</span></span></pre></div>

<div class="spiro"> &nbsp;</div>

<div id="comments">

	<h3 class="blue_bold"><img alt="*" height="13" src="/images/f/bullets/pixels/asterisk.png.?1201129166" width="13" /> Comments</h3>
	
	



<div class="normal" id="comment_43"><div class="comments_left"><p><span class="posted_ago">ABOUT 1 MONTH AGO</span><br/> <span class="email">shikha</span></p></div><div class="comments_right"><h6>Limit is not working with integer or bigint</h6><p>i have tried so many times but :limit is not working. code:

add_column(:table, :field, :bigint, {:limit => 13})</p></div><div class="reply_comment" id="reply_43"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/43/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_43"></div>

<div class="odd" id="comment_44"><div class="comments_left"><p><span class="posted_ago">ABOUT 1 MONTH AGO</span><br/> <span class="email">Richard Patching</span></p></div><div class="comments_right"><h6>Limit is not working with integer or bigint</h6><p>To create a bigint you need to set the integer limit to be between 5 and 8 bytes.

The following example would give you a bigint with length 20:

t.integer :foo, :limit => 8</p></div><div class="reply_comment" id="reply_44"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/44/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_44"></div></div></div>

<div class="normal" id="comment_32"><div class="comments_left"><p><span class="posted_ago">4 MONTHS AGO</span><br/> <span class="email">mosquete</span></p></div><div class="comments_right"><h6>Minor mistake</h6><p>In "Fixtures" section, item 4, "migration.rb" was swapped with "customers.yml".
</p></div><div class="reply_comment" id="reply_32"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/32/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_32"></div></div>

<div class="normal" id="comment_29"><div class="comments_left"><p><span class="posted_ago">4 MONTHS AGO</span><br/> <span class="email">Ryan Shillington</span></p></div><div class="comments_right"><h6>rename_column is wrong too</h6><p>You're missing the table argument from the rename_column syntax as well.
</p></div><div class="reply_comment" id="reply_29"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/29/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_29"></div></div>

<div class="normal" id="comment_28"><div class="comments_left"><p><span class="posted_ago">4 MONTHS AGO</span><br/> <span class="email">Gideon</span></p></div><div class="comments_right"><h6>rename_table args reversed</h6><p>Thanks for this very useful resource.

The args for rename_table should be :old_table, :new_table (and rename_table is actually listed twice too).</p></div><div class="reply_comment" id="reply_28"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/28/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_28"></div></div>





<div class="normal" id="comment_20"><div class="comments_left"><p><span class="posted_ago">6 MONTHS AGO</span><br/> <span class="email">Dougle</span></p></div><div class="comments_right"><h6>Drops?</h6><p>What about drops for migrating down</p></div><div class="reply_comment" id="reply_20"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/20/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_20"></div>

<div class="odd" id="comment_24"><div class="comments_left"><p><span class="posted_ago">5 MONTHS AGO</span><br/> <span class="email">txarli</span></p></div><div class="comments_right"><h6>Cortesy</h6><p>what ahout a little bit of courtesy?
So, when you find an excelent guide to migrations, the only thing to say is "What about drops for migrating down"

pff...</p></div><div class="reply_comment" id="reply_24"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/24/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_24"></div>

<div class="normal" id="comment_25"><div class="comments_left"><p><span class="posted_ago">5 MONTHS AGO</span><br/> <span class="email">Dougle</span></p></div><div class="comments_right"><h6>Drops?</h6><p>"So, when you find an excelent guide to migrations, the only thing to say is "What about drops for migrating down" pff..."

Exactly what i mean.. it would be an "excellent" guide if it had drop syntax, that's not discourteous at all.</p></div><div class="reply_comment" id="reply_25"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/25/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_25"></div></div></div></div>

<div class="normal" id="comment_17"><div class="comments_left"><p><span class="posted_ago">6 MONTHS AGO</span><br/> <span class="email">Cwelle</span></p></div><div class="comments_right"><h6>Very nice, buy one type is missing</h6><p>Very nice, buy one type is missing. It's :text. Representing TEXT in mysql.</p></div><div class="reply_comment" id="reply_17"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/17/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_17"></div></div>

<div class="normal" id="comment_6"><div class="comments_left"><p><span class="posted_ago">8 MONTHS AGO</span><br/> <span class="email">Joe Lewis</span></p></div><div class="comments_right"><h6>Very nice - one small bug</h6><p>Thank you for the organized approach to looking at migrations - much appreciated. One small item - I noticed in the PDF version, the rename_column item uses rename_table in the code example (rename_table :old_column_name, :new_column_name). </p></div><div class="reply_comment" id="reply_6"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/6/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_6"></div></div>

<div class="normal" id="comment_5"><div class="comments_left"><p><span class="posted_ago">8 MONTHS AGO</span><br/> <span class="email">tom</span></p></div><div class="comments_right"><h6>migrate</h6><p>beneficial</p></div><div class="reply_comment" id="reply_5"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/5/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_5"></div></div>

<div class="normal" id="comment_3"><div class="comments_left"><p><span class="posted_ago">9 MONTHS AGO</span><br/> <span class="email">Tomomi</span></p></div><div class="comments_right"><h6>Very Beneficial</h6><p>Very Beneficial resource code.</p></div><div class="reply_comment" id="reply_3"><a href="http://www.yahoo.com" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/3/child_comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Reply to this comment</a></div><div id="reply_form_3"></div></div>
	
	<div id="add_comment">
		<p><img alt="*" height="5" src="/images/f/bullets/pixels/diamond.png.?1201129166" width="5" /> <a href="#" onclick="new Ajax.Request('/ruby_on_rails/contents/1/comments/new', {asynchronous:true, evalScripts:true, method:'get'}); return false;">Add new comment</a></p>
	</div>

</div>


</div>
		</div>
		
		<div id="footer" class="clearfix">
			<div id="footer_man"><img alt="Footer_man" src="/images/f/backgrounds/footer_man.png.?1231935200" /></div>
			<img alt="Spiral_circle" src="/images/f/backgrounds/spiral_circle.png.?1231935089" />
		</div>
	
	</div>
</body>
</html>